"use strict";(self.webpackChunkmesodocs=self.webpackChunkmesodocs||[]).push([[674],{4137:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>v});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(t),m=o,v=c["".concat(s,".").concat(m)]||c[m]||d[m]||r;return t?a.createElement(v,i(i({ref:n},u),{},{components:t})):a.createElement(v,i({ref:n},u))}));function v(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[c]="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=t[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4404:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=t(7462),o=(t(7294),t(4137));const r={title:"Conda",sidebar_position:1},i=void 0,l={unversionedId:"arch_exp/turpan/logiciels/envpython/conda",id:"arch_exp/turpan/logiciels/envpython/conda",title:"Conda",description:"Conda ou miniconda ?",source:"@site/docs/arch_exp/turpan/logiciels/envpython/conda.md",sourceDirName:"arch_exp/turpan/logiciels/envpython",slug:"/arch_exp/turpan/logiciels/envpython/conda",permalink:"/documentation/user-documentation/arch_exp/turpan/logiciels/envpython/conda",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Conda",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"L'\xe9cosyst\xe8me Python",permalink:"/documentation/user-documentation/arch_exp/turpan/logiciels/envpython/"},next:{title:"Python",permalink:"/documentation/user-documentation/arch_exp/turpan/logiciels/envpython/python"}},s={},p=[{value:"Conda ou miniconda ?",id:"conda-ou-miniconda-",level:2},{value:"Charger l\u2019environnement",id:"charger-lenvironnement",level:2},{value:"V\xe9rifier quels sont les environnements disponibles",id:"v\xe9rifier-quels-sont-les-environnements-disponibles",level:2},{value:"Activer un environnement",id:"activer-un-environnement",level:2},{value:"V\xe9rifier les paquets install\xe9s dans l\u2019environnement courant",id:"v\xe9rifier-les-paquets-install\xe9s-dans-lenvironnement-courant",level:2},{value:"Rechercher un paquet \xe0 installer",id:"rechercher-un-paquet-\xe0-installer",level:2},{value:"Installer des paquets dans l\u2019environnement courant",id:"installer-des-paquets-dans-lenvironnement-courant",level:2},{value:"Installer un paquet avec pip",id:"installer-un-paquet-avec-pip",level:2},{value:"Pour installer un environnement sp\xe9cifique \xe0 partir d&#39;un environnement existant :",id:"pour-installer-un-environnement-sp\xe9cifique-\xe0-partir-dun-environnement-existant-",level:2},{value:"Faire le m\xe9nage dans ses environnements",id:"faire-le-m\xe9nage-dans-ses-environnements",level:2},{value:"Faire le m\xe9nage dans ses paquets",id:"faire-le-m\xe9nage-dans-ses-paquets",level:2}],u={toc:p},c="wrapper";function d(e){let{components:n,...t}=e;return(0,o.kt)(c,(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"conda-ou-miniconda-"},"Conda ou miniconda ?"),(0,o.kt)("p",null,'conda est un gestionnaire d\u2019environnements appel\xe9 miniconda et un ensemble de paquets utiles pour les applications scientifiques. Nous avons fait le choix d\u2019installer miniconda seul, et de d\xe9finir plusieurs environnements"types" que vous pourrez utiliser en fonction de votre projet.'),(0,o.kt)("p",null,"Si ces environnements ne vous conviennent pas, nous expliquons ici comment construire votre propre environnement"),(0,o.kt)("h2",{id:"charger-lenvironnement"},"Charger l\u2019environnement"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"module purge\nmodule load conda/22.11.1\n")),(0,o.kt)("h2",{id:"v\xe9rifier-quels-sont-les-environnements-disponibles"},"V\xe9rifier quels sont les environnements disponibles"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"conda env list\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"# conda environments:  \n#base                     /usr/local/miniconda/22.11.1\npython-3.10.9            /usr/local/miniconda/22.11.1/envs/python-3.10.9\npython-tools-3.10.9      /usr/local/miniconda/22.11.1/envs/python-tools-3.10.9\n"))),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Le caract\xe8re \u2019*\u2019 montre quel est votre environnement courant")),(0,o.kt)("h2",{id:"activer-un-environnement"},"Activer un environnement"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"conda activate python-3.10.9\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"(python-3.10.9) [toto@turpanlogin1 ~]$\n"))),(0,o.kt)("h2",{id:"v\xe9rifier-les-paquets-install\xe9s-dans-lenvironnement-courant"},"V\xe9rifier les paquets install\xe9s dans l\u2019environnement courant"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(python-tools-3.10.9) [toto@turpanlogin1 ~]$ conda list\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"# packages in environment at /usr/local/miniconda/22.11.1/envs/python-tools-3.10.9:\n# \n# Name                    Version                   Build  Channel\n_libgcc_mutex             0.1                        main\n_openmp_mutex             5.1                      51_gnu\nanyio                     3.5.0           py310hd43f75c_0\nargon2-cffi               21.3.0             pyhd3eb1b0_0\nargon2-cffi-bindings      21.2.0          py310h2f4d8fa_0     \n[...]\n"))),(0,o.kt)("h2",{id:"rechercher-un-paquet-\xe0-installer"},"Rechercher un paquet \xe0 installer"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(python-tools-3.10.9) [toto@turpanlogin1 ~]$ conda search tensorflow\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"Loading channels: done\n# Name                       Version           Build  Channel             \ntensorflow                     2.5.0 eigen_py37h1457a7e_0  pkgs/main           \ntensorflow                     2.5.0 eigen_py38h761523d_0  pkgs/main           \ntensorflow                     2.5.0 eigen_py39hf3b6bb3_0  pkgs/main\n"))),(0,o.kt)("h2",{id:"installer-des-paquets-dans-lenvironnement-courant"},"Installer des paquets dans l\u2019environnement courant"),(0,o.kt)("p",null,"Pour installer une version sp\xe9cifique de numpy :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(python-tools-3.10.9) [toto@turpanlogin1 ~]$ conda install numpy=1.22\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"Collecting package metadata (current_repodata.json): done\nSolving environment: failed with initial frozen solve. Retrying with flexible solve.\nCollecting package metadata (repodata.json): done\nSolving environment: done\n\n==> WARNING: A newer version of conda exists. <==\n current version: 22.11.1\n latest version: 23.1.0\n\nPlease update conda by running\n\n   $ conda update -n base -c defaults conda\n\nOr to minimize the number of packages updated during conda update use\n\n    conda install conda=23.1.0\n\n## Package Plan ##\n\n environment location: /usr/local/miniconda/22.11.1/envs/python-tools-3.10.9\n\n added / updated specs:\n     - numpy=1.22\n\n\nThe following packages will be downloaded:\n\n   package                    |            build\n   ---------------------------|-----------------\n   numpy-1.22.3               |  py310h983bb6b_0          10 KB\n   numpy-base-1.22.3          |  py310he6496e5_0        11.0 MB\n   ------------------------------------------------------------\n                                          Total:        11.0 MB\n\nThe following packages will be DOWNGRADED:\n\n numpy                              1.23.5-py310hce24898_0 --\x3e 1.22.3-py310h983bb6b_0 \n numpy-base                         1.23.5-py310h5f09236_0 --\x3e 1.22.3-py310he6496e5_0\n\n[...]\n"))),(0,o.kt)("h2",{id:"installer-un-paquet-avec-pip"},"Installer un paquet avec pip"),(0,o.kt)("p",null,"Certains logiciels s\u2019installent avec pip et pas avec Conda. Il est tout-\xe0-fait possible d\u2019utiliser pip dans un environnement conda, mais nous vous recommandons de commencer par lire ",(0,o.kt)("a",{parentName:"p",href:"https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#using-pip-in-an-environment"},"cette documentation (en anglais)"),", qui explique les pr\xe9cautions \xe0 prendre."),(0,o.kt)("h2",{id:"pour-installer-un-environnement-sp\xe9cifique-\xe0-partir-dun-environnement-existant-"},"Pour installer un environnement sp\xe9cifique \xe0 partir d'un environnement existant :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(python-tools-3.10.9) [toto@turpanlogin1 ~]$ conda create -n mon_environnement --clone python-tools-3.10.9\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"Source:      /usr/local/miniconda/22.11.1/envs/python-tools-3.10.9\nDestination: /usr/local/miniconda/22.11.1/envs/mon_environnement\nPackages: 152\nFiles: 0\n\nDownloading and Extracting Packages\n\nPreparing transaction: done\nVerifying transaction: done\nExecuting transaction: done\n#\n# To activate this environment, use\n#\n#     $ conda activate mon_environnement\n#\n# To deactivate an active environment, use\n#\n#     $ conda deactivate\n"))),(0,o.kt)("p",null,"Activer ce nouvel environnement :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(python-tools-3.10.9) [sysinst@turpanlogin1 ~]$ conda activate mon_environnement\n")),(0,o.kt)("admonition",{title:"Note",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Afin que tout se passe bien, et notamment l\u2019utilisation ult\xe9rieure de pip dans votre environnement, il est pr\xe9f\xe9rable de cloner l\u2019environnement base, par exemple plut\xf4t que de cr\xe9er un environnement \xe0 partir de rien avec le switch --clone base")),(0,o.kt)("p",null,"Pour installer un nouveau paquet dans cet environnement :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(mon_environnement) [toto@turpanlogin1 ~]$ conda install mon_paquet\n")),(0,o.kt)("h2",{id:"faire-le-m\xe9nage-dans-ses-environnements"},"Faire le m\xe9nage dans ses environnements"),(0,o.kt)("p",null,"Pour supprimer un de mes environnements dont je n'ai plus besoin :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"(mon_environnement) [sysinst@turpanlogin1 ~]$ conda deactivate\n(python-tools-3.10.9) [sysinst@turpanlogin1 ~]$ conda env remove -n mon_environnement\n")),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"Remove all packages in environment /usr/local/miniconda/22.11.1/envs/mon_environnement:\n"))),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Supprimer les environnements inutiles permet d'\xe9conomiser l\u2019espace disque.")),(0,o.kt)("h2",{id:"faire-le-m\xe9nage-dans-ses-paquets"},"Faire le m\xe9nage dans ses paquets"),(0,o.kt)("p",null,"Toutes ces manipulations vont remplir votre home, en particulier vous vous retrouverez avec un grand nombre de fichiers .tgz qui ne servent plus \xe0 rien une fois les paquets install\xe9s. C\u2019est ce qu\u2019on appelle le cache. Par prudence, commencez par une commande qui ne fera rien d\u2019autre que de vous dire ce qui sera nettoy\xe9 :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"conda clean -a --dry-run\n")),(0,o.kt)("p",null,"Si vous souhaitez garder des tgz (pour pouvoir reproduire votre installation ailleurs par exemple), c\u2019est le moment de les mettre en lieu s\xfbr ! Et quand vous \xeates pr\xeats :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"conda clean -a\n")),(0,o.kt)("p",null,"Si certains paquets ont \xe9t\xe9 install\xe9s avec la commande pip, vous pouvez utiliser ces commandes pour supprimer les fichiers temporaires mis en cache lors de l'installation :"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Localiser le r\xe9pertoire contenant le cache : ",(0,o.kt)("inlineCode",{parentName:"li"},"pip cache dir")),(0,o.kt)("li",{parentName:"ul"},"Purger les fichiers du cache : ",(0,o.kt)("inlineCode",{parentName:"li"},"pip cache purge"))))}d.isMDXComponent=!0}}]);