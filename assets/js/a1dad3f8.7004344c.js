"use strict";(self.webpackChunkmesodocs=self.webpackChunkmesodocs||[]).push([[5108],{4137:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>v});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u=r.createContext({}),i=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=i(e.components);return r.createElement(u.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,u=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=i(t),m=o,v=p["".concat(u,".").concat(m)]||p[m]||d[m]||a;return t?r.createElement(v,s(s({ref:n},c),{},{components:t})):r.createElement(v,s({ref:n},c))}));function v(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=m;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l[p]="string"==typeof e?e:o,s[1]=l;for(var i=2;i<a;i++)s[i]=t[i];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4999:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>i});var r=t(7462),o=(t(7294),t(4137));const a={title:"Lancer un calcul",sidebar_position:5},s=void 0,l={unversionedId:"code_form/zen/jobs",id:"code_form/zen/jobs",title:"Lancer un calcul",description:"Pour effectuer des calculs sur Zen il faut obligatoirement utiliser le gestionnaire de travaux slurm.",source:"@site/docs/code_form/zen/jobs.md",sourceDirName:"code_form/zen",slug:"/code_form/zen/jobs",permalink:"/documentation/user-documentation/code_form/zen/jobs",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Lancer un calcul",sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Stockage",permalink:"/documentation/user-documentation/code_form/zen/stockage"},next:{title:"Environnement logiciel",permalink:"/documentation/user-documentation/code_form/zen/software"}},u={},i=[],c={toc:i},p="wrapper";function d(e){let{components:n,...t}=e;return(0,o.kt)(p,(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Pour effectuer des calculs sur Zen il faut obligatoirement utiliser le gestionnaire de travaux ",(0,o.kt)("inlineCode",{parentName:"p"},"slurm"),"."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Pour rappel, il est strictement interdit de lancer des calculs directement sur la frontale. C\xe9pendant, vous pouvez y compiler vos codes et \xe9diter des scripts.")),(0,o.kt)("p",null,"Si vous n'\xeates pas familier avec slurm il est vivement conseill\xe9 de suivre cette ",(0,o.kt)("a",{parentName:"p",href:"/HOWTO/slurm"},"introduction g\xe9n\xe9rale \xe0 ",(0,o.kt)("inlineCode",{parentName:"a"},"slurm")," ici"),"."),(0,o.kt)("p",null,"Cette page se concentre sur les particularit\xe9s du cluster Zen."),(0,o.kt)("h1",{id:"lancer-un-job-sur-zen"},"Lancer un job sur Zen"),(0,o.kt)("p",null,"Pour ex\xe9cuter votre code sur les n\u0153uds calcul il faut soumettre un script via la commande ",(0,o.kt)("inlineCode",{parentName:"p"},"sbatch"),"."),(0,o.kt)("p",null,"Voici un exemple minimal de script slurm:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"#!/bin/bash\n#SBATCH --nodes=1\n#SBATCH --time=00:10:00\n\nhostname\nsleep 600\n")),(0,o.kt)("p",null,"Pour cr\xe9er ce script sur la frontale de Zen, vous pouvez l'\xe9diter directement sur le n\u0153ud ",(0,o.kt)("inlineCode",{parentName:"p"},"login")," (par ex. avec vi, vim, emacs, nano) ou bien l'\xe9diter localement et le copier de votre machine sur Zen (par ex. avec rsync ou scp)."),(0,o.kt)("p",null,"Supposons que votre script s'appelle ",(0,o.kt)("inlineCode",{parentName:"p"},"job.slurm"),". Vous pouvez le soumettre avec"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"sbatch job.slurm\n")),(0,o.kt)("p",null,"et slurm vous repondra en donnant un identifiant unique \xe0 votre job."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Submitted batch job 56540\n")),(0,o.kt)("p",null,"Avec la commande ",(0,o.kt)("inlineCode",{parentName:"p"},"squeue")," vous pouvez suivre l'\xe9tat de votre job et ",(0,o.kt)("inlineCode",{parentName:"p"},"scancel")," permet de l'arr\xeater."),(0,o.kt)("p",null,"Cliquez ",(0,o.kt)("a",{parentName:"p",href:"/HOWTO/slurm"},"ici")," pour aller plus loin avec slurm."),(0,o.kt)("h1",{id:"jobs-interactifs"},"Jobs interactifs"),(0,o.kt)("p",null,"##\xa0Connexion par ssh"),(0,o.kt)("p",null,"Il n'est pas possible de se connecter directement par ssh aux n\u0153uds de calcul, sauf si vous avez un job actif sur le n\u0153ud."),(0,o.kt)("p",null,"Si vous tentez de vous connecter par ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh node001")," alors vous obtenez alors le message suivant"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Access denied by pam_slurm_adopt: you have no active jobs on this node\nConnection closed by 10.30.0.1 port 22\n")),(0,o.kt)("p",null,"Par contre, vous pouvez vous connecter par ssh aux n\u0153uds o\xf9 vous avez une r\xe9servation active (par ",(0,o.kt)("inlineCode",{parentName:"p"},"ssh node0xx"),")."),(0,o.kt)("p",null,"Votre session ssh sera contrainte par les ressources allou\xe9es dans votre job le plus r\xe9cent sur le n\u0153ud."),(0,o.kt)("p",null,"##\xa0Session interactive via srun"),(0,o.kt)("p",null,"Vous pouvez d\xe9marrer une session interactive comme ceci:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ srun --nodes=1 --ntasks-per-node=1 --time=01:00:00 --pty bash -i\n")),(0,o.kt)("p",null,"Ici nous demandons un seul c\u0153ur sur un n\u0153ud pendant une heure. L'invite de commande appara\xeetre d\xe8s que le job d\xe9marre."),(0,o.kt)("h1",{id:"powersave"},"D\xe9marrage des n\u0153uds"),(0,o.kt)("p",null,"A des fins d'\xe9conomie d'\xe9nergie, les n\u0153uds de calcul de Zen s'arr\xeatent compl\xe8tement au bout de 3 heures d'inactivit\xe9."),(0,o.kt)("p",null,"Si les seuls n\u0153uds pour satisfaire votre requ\xeate sont \xe9teints, alors votre job se lancera seulement apr\xe8s environ 5 minutes, le temps n\xe9cessaire au serveur pour d\xe9marrer."))}d.isMDXComponent=!0}}]);